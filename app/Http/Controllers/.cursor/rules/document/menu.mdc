---
description: 3.2 サイドメニューを設定する方法
globs: **/*.php
alwaysApply: false
---
# サイドメニューを設定する方法
## 定義ファイルの形式（JSON形式）
サイドメニューの設定は、JSON形式の定義ファイルとして記述します。作成した定義ファイルは、`config/menu.php` に保存してください。

- メニューのルート名は `root` を使用します。
- `sub` にサブメニュー名を指定することで、階層構造のメニューを作成できます。
- メニューの階層は最大3階層まで対応しています。

各メニュー項目は、以下のような連想配列で定義します。

## メニュー項目の設定内容
### リンク先の設定
|キー項目|説明|
|:-----------|:-----------|
|name|メニューのルート名|
|argv|ルート取得時の引数|
|url|リンク先のURL（直接指定）|
|sub|サブメニューのメニュー名|

### 見栄えの設定
|キー項目|説明|
|:-----------|:-----------|
|icon|Font Awesomeのアイコン名|
|lang|多言語対応ラベル（言語ファイルを参照）|
|label|ラベルを直接指定|
|line|第1階層のみ：メニューの上に区切り線を表示|
|index|第1階層のみ：メニューの上に小見出しを表示|

### 表示条件の設定
|キー項目|説明|
|:-----------|:-----------|
|role|`true` にすると権限がなくても常に表示|
|guard|指定した Guard 条件を満たす場合のみ表示|

## サンプルコード
```php
<?php

return [
    'root' => [
        0 => [
            'name' => 'home',
            'lang' => 'template:admin_menu_home',
            'icon' => 'fa-home',
            'role' => true,
        ],
        1 => [
            'line' => true,
            'lang' => 'template:admin_menu_top',
            'icon' => 'fa-cogs',
            'sub' => 'admin_menu',
            'role' => true,
        ],
    ],
    'admin_menu' => [
        0 => [
            'name' => 'admin.user.index',
            'label' => 'ユーザー管理',
            'icon' => 'fa-users',
        ],
    ],
];
```

## Guardによるサイドメニューの表示制御方法
サイドメニューをユーザーのGuard（認証ガード）に応じて出し分けたい場合は、各メニュー項目に `guard` を設定します。`guard` を設定しない場合、そのメニューはすべてのGuardで常に表示されます。

## サンプルコード
```php
<?php

return [
    'root' => [
        0 => [
            'name' => 'home',
            'label' => '共通メニュー',
            'icon' => 'fa-home',
            'role' => true,
        ],
        1 => [
            'name' => 'home',
            'label' => '管理者メニュー',
            'icon' => 'fa-cogs',
            'role' => true,
            'guard' => 'web',
        ],
        2 => [
            'name' => 'home',
            'label' => 'メンバーメニュー',
            'icon' => 'fa-cogs',
            'role' => true,
            'guard' => 'member',
        ],
    ],
];
```
