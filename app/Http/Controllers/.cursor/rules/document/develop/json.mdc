---
description: 定義ファイル（JSON形式）の作成方法
globs: **/*.php, **/*.json
alwaysApply: false
---
# 定義ファイル（JSON形式）の作成方法
## 定義ファイルの作成方法
管理画面の構成情報を、JSON形式の定義ファイルとして記述します。作成した定義ファイルは、`docs/develop/` に保存してください（`docs/develop/sample.json` など）。定義ファイルは、以下の4つの主要なセクションで構成されています。

|キー項目|説明|
|:-----------|:-----------|
|controller|コントローラーに関する設定|
|form|入力フォームの定義|
|menu|メニューの表示設定|
|route|ルーティングの設定|

## コントローラーに関する設定項目
|キー項目|説明|例|
|:-----------|:-----------|:-----------|
|controllerName|コントローラーのクラス名を指定します|Admin/SampleController|
|viewPrefix|関連するビューのパスを指定します（ドット区切り）|admin.sample|
|modelName|使用するモデルの名前を指定します|Admin/Sample|
|loopItem|一覧表示などで使用するテーブル名を指定します|samples|
|paginateNum|1ページに表示する件数を指定します（0の場合はページングなし）|20|
|noticeItem|操作完了時のメッセージに使用する項目名（例：登録名など）|name|

## 入力フォームの定義項目
入力フォームは、フォーム名をキーとした連想配列で定義します。各フォームには、以下の項目を連想配列形式で設定します。

### 入力タイプ一覧
|type|説明|
|:-----------|:-----------|
|text|1行テキスト入力|
|textarea|複数行テキスト入力|
|datepicker|日付入力|
|timepicker|日付＋時間入力|
|number|数値入力|
|select|プルダウン選択|
|radio|ラジオボタン|
|checkbox|チェックボックス|
|select2|検索機能付きプルダウン|
|upload|ファイルアップロード|

### テキスト入力タイプの定義
対象タイプ：`type=text、textarea、datepicker、timepicker、number`
|キー項目|説明|記述例|
|:-----------|:-----------|:-----------|
|type|入力タイプ|text|
|label|表示ラベル|名前|
|required|必須入力かどうか|true|
|placeholder|プレースホルダー（入力例）|入力してください|
|disabled|入力不可にするか|false|
|readonly|読み取り専用にするか|false|

### 選択入力タイプの定義
対象タイプ：`type=select、radio、checkbox`
|キー項目|説明|記述例|
|:-----------|:-----------|:-----------|
|type|入力タイプ|checkbox|
|label|表示ラベル|仕事|
|required|必須入力かどうか|true|
|option|選択肢（値とラベルの連想配列）|"1": "学生", "2": "会社員"|
|default|初期選択値|[1, 2]|

選択肢のラベルにはHTMLタグの使用が可能です。

### 検索できるプルダウンの定義
対象タイプ：`type=select2`
|キー項目|説明|記述例|
|:-----------|:-----------|:-----------|
|type|入力タイプ|select2|
|label|表示ラベル|仕事|
|option|選択肢（値とラベルの連想配列）|"1": "学生", "2": "会社員"|
|default|初期選択値|[1, 2]|
|required|必須入力かどうか|true|
|multiple|複数選択可能か|true|

選択肢のラベルにはHTMLタグの使用が可能です。

### ファイルアップロードの定義
対象タイプ：`type=upload`
|キー項目|説明|記述例|
|:-----------|:-----------|:-----------|
|type|入力タイプ|upload|
|label|表示ラベル|アップロードファイル|
|required|必須入力かどうか|true|
|multiple|複数ファイルのアップロード可否|true|

## メニューの表示設定項目
メニューの表示に関する設定は、以下の項目で構成されます。
|設定項目|説明|記述例|
|:-----------|:-----------|:-----------|
|name|メニューがリンクするルート名（ルーティング名）を指定します|admin.sample.index|
|lang|メニューに表示するラベル（日本語など）を指定します|サンプル|
|icon|メニューに表示するアイコン（Font Awesomeのクラス名）を指定します|fa-cogs|
|role|表示制御に使用するロール（権限）設定。trueの場合、ロールに応じて表示が制限されます|true|

## ルーティングの設定項目
ルーティングの設定では、コントローラーに対応するURLやルート名の共通部分を定義します。
|設定項目|説明|記述例|
|:-----------|:-----------|:-----------|
|routePrefix|URLの共通パスを指定します。コントローラーのルートに対応します|admin/sample|
|routeName|ルート名の共通プレフィックスを指定します。ビューやリンク生成時に使用されます|admin.sample.|

## サンプルコード
### 企業情報の管理画面定義
- controller
  - CompanyController を使用し、ビューは admin.company に配置。
  - モデルは Company、一覧表示は companies テーブル。
  - ページネーションは 1ページ20件、通知メッセージには name を使用。
- form
  - code: 証券番号（テキスト入力、必須）
  - name: 名前（テキスト入力、必須）
- menu
  - メニュー名は「企業」、アイコンは fa-building（Font Awesome）
- route
  - URLは /admin/company、ルート名は admin.company. をプレフィックスとして使用。

```json
{
    "controller": {
        "controllerName": "CompanyController",
        "viewPrefix": "admin.company",
        "modelName": "Company",
        "loopItem": "companies",
        "paginateNum": 20,
        "noticeItem": "name"
    },
    "form": {
        "code": {
            "label": "証券番号",
            "type": "text",
            "required": true
        },
        "name": {
            "label": "名前",
            "type": "text",
            "required": true
        }
    },
    "menu": {
        "name": "admin.company.index",
        "lang": "企業",
        "icon": "fa-building"
    },
    "route": {
        "routePrefix": "admin\/company",
        "routeName": "admin.company."
    }
}
```

### ソリューション管理画面定義
- controller
  - コントローラーは Admin/SolutionController、ビューは admin.solution。
  - モデルは Admin/Solution、一覧表示は solutions テーブル。
  - ページネーションは 20件、通知メッセージには name を使用。
- form
  - disabled_at: ステータス（ラジオボタン、HTMLラベル付き、有効／無効）
  - name: 名前（テキスト入力、必須）
  - pattern: パターン選択（プルダウン、パターンA/B）
- menu
  - メニュー名は「ソリューション」、アイコンは fa-tag、ロール制御あり（role: true）
- route
  - URLは /admin/solution、ルート名は admin.solution. をプレフィックスとして使用。

```json
{
    "controller": {
        "controllerName": "Admin\/SolutionController",
        "viewPrefix": "admin.solution",
        "modelName": "Admin\/Solution",
        "loopItem": "solutions",
        "paginateNum": 20,
        "noticeItem": "name"
    },
    "form": {
        "disabled_at": {
            "label": "ステータス",
            "type": "radio",
            "option": [
                "<span class='badge text-bg-success me-2'>有効<\/span>",
                "<span class='badge text-bg-warning me-2'>無効<\/span>"
            ],
            "default": "1",
            "required": true
        },
        "name": {
            "label": "名前",
            "type": "text",
            "required": true
        },
        "pattern": {
            "label": "パターン",
            "type": "select",
            "option": [
                "パターンA",
                "パターンB"
            ],
            "required": true
        }
    },
    "menu": {
        "name": "admin.solution.index",
        "lang": "ソリューション",
        "icon": "fa-tag",
        "role": true
    },
    "route": {
        "routePrefix": "admin\/solution",
        "routeName": "admin.solution."
    }
}
```
